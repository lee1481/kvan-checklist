# 케이밴 제품 시공 점검표 웹앱 📋✍️

## 프로젝트 개요
케이밴 제품 시공 점검표를 디지털화한 **3페이지 구조의 터치 최적화 웹 애플리케이션**입니다. 
현장에서 터치로 체크하고, 디지털 서명 후 고객 이메일로 자동 발송하는 스마트 점검표 시스템입니다.

## 🎨 3페이지 레이아웃 구조

### 📄 **Page 1: 메인 페이지** (A4 사이즈 비율 794×1123px)
✅ **A4 사이즈 비율 적용** (v2.3.0)
- 정확한 A4 용지 비율 (210mm × 297mm)
- 픽셀 기준: 794px × 1123px (96 DPI)
- 인쇄 최적화 레이아웃
- 반응형 디자인 (모바일에서는 자동 조정)

1. **시공 정보** (2단 레이아웃)
   - 시공일자 (전체 너비)
   - 고객명 + 고객 전화번호 (2단 가로 배치)
   - 고객 서명 캔버스 (80px 높이, 전체 너비)
   - 차량 차대번호 + 주행거리 (2단 가로 배치)

2. **품질보증서** (공간 최적화)
   - 5개 보증 조항
   - 7개 유상 수리 조건
   - 케이밴 연락처 정보

3. **시공자 정보**
   - 시공자명 (전체 너비)
   - 시공자 서명 캔버스 (80px 높이, 전체 너비)

4. **이메일 발송**
   - 이메일 주소 입력 (전체 너비)
   - 📧 이메일 발송 버튼 (전체 너비)

### 📦 **Page 2: 제품 선택 페이지**
- **기아PV5** (좌측)
  - 스마트패키지
  - 워크스테이션
  - 3단부품선반
  - 3단선반
- **밀워키PV5** (우측)
  - 스마트에디션
  - 워크스테이션
  - 3단부품선반
  - 3단선반
- **기타** (직접 입력)

### ✅ **Page 3: 체크리스트 페이지**
6개 체크리스트 섹션 (터치 체크박스):
- 차바닥 (태고합판, 알루미늄체크판, 부자재)
- 격벽타공판
- 격벽 2단 선반
- 3단 선반 (휠 좌측/우측)
- 부품 3단 선반 (휠 좌측/우측)
- 워크스페이스 (휠 우측)

## ✅ 완료된 기능

### 1. 🎨 3페이지 레이아웃 구조 (v2.3.0) 🆕
- ✅ **Page 1: 메인 페이지** - A4 사이즈 최적화 (794×1123px)
  - **2단 레이아웃 적용**: 고객명+전화번호, 차대번호+주행거리 가로 배치
  - 시공 정보 (시공일자, 고객정보, 차량정보, 주행거리)
  - 고객 서명 캔버스 (80px 높이, 시공 정보 내 통합)
  - 품질보증서 (5개 조항 + 유상수리 조건)
  - 시공자 정보 + 시공자 서명 (80px 높이)
  - 이메일 입력 및 발송 버튼
  - **이미지 다운로드 기능 삭제** (이메일 발송만 유지)
- ✅ **Page 2: 제품 선택 페이지**
  - 기아PV5 / 밀워키PV5 체크박스
  - 2단 레이아웃 (좌/우)
  - 기타 제품 직접 입력
- ✅ **Page 3: 체크리스트 페이지**
  - 6개 체크리스트 섹션
  - 50x50px 터치 체크박스
- ✅ 페이지 구분선 (점선 효과)
- ✅ A4 비율 최적화 (794px × 1123px, 210mm × 297mm)

### 2. 태블릿 친화적 UI
- ✅ 큰 터치 영역의 체크박스 (50x50px)
- ✅ 반응형 디자인 (모바일/태블릿 최적화)
- ✅ 터치 피드백 애니메이션
- ✅ 확대/축소 방지 (user-scalable=no)

### 3. 시공 정보 입력 폼 (2단 레이아웃)
- ✅ 시공일자 (Date picker, 전체 너비)
- ✅ 고객명 + 고객 전화번호 (2단 가로 배치)
- ✅ 차량 차대번호 + 주행거리 (2단 가로 배치)
- ✅ **제품 시공명 선택** (Page 2)
  - 기아PV5 스마트패키지/워크스테이션/3단부품선반/3단선반
  - 밀워키PV5 스마트에디션/워크스테이션/3단부품선반/3단선반
  - **기타 (직접 입력)** 옵션 제공

### 4. 점검 체크리스트 (Page 3)
다음 6개 섹션으로 구성:
- ✅ 차바닥 (태고합판, 알루미늄체크판, 부자재)
- ✅ 격벽타공판
- ✅ 격벽 2단 선반
- ✅ 3단 선반 (휠 좌측/우측)
- ✅ 부품 3단 선반 (휠 좌측/우측)
- ✅ 워크스페이스 (휠 우측)

### 5. 디지털 서명 기능
- ✅ Canvas 기반 서명 패드
- ✅ 시공자 서명 (이름 + 서명 80px) - Page 1 하단
- ✅ 고객 서명 (이름 + 서명 80px) - Page 1 시공 정보 내
- ✅ 서명 지우기 기능
- ✅ 마우스 및 터치 입력 지원
- ✅ **좌표 정확도 개선 (v1.7.0)**
  - Canvas scale 비율 자동 계산
  - 마우스/터치 커서와 그려지는 선 정확히 일치
  - 모든 화면 크기에서 정확한 서명 가능

### 6. 📧 이메일 발송 기능
- ✅ **단일 이메일 주소 입력** (Page 1)
- ✅ Resend API 통합 완료
- ✅ HTML 이메일 템플릿 (CID 첨부 방식)
- ✅ 서명 이메일 첨부
- ✅ 발송 성공 알림

### 7. 폼 유효성 검증
- ✅ 필수 항목 입력 확인
- ✅ 이메일 형식 검증
- ✅ 서명 완료 여부 확인
- ✅ 사용자 친화적 오류 메시지
- ✅ 공통 검증 함수 (validateForm)

### 8. API 엔드포인트
- ✅ `POST /api/submit` - 점검표 제출 (이메일 발송)

## 🚧 제거된 기능

### v2.3.0 (2026-02-15)
- ❌ **JPG/PNG 다운로드 기능 삭제**
  - JPG 다운로드 버튼 제거
  - PNG 다운로드 버튼 제거
  - `window.downloadJPG` 함수 삭제
  - Loading Overlay 제거
  - 이메일 발송 기능만 유지

### v2.0.0 (이전)
- ❌ **사진 첨부 기능 제거**
  - 섹션별 사진 업로드 버튼 삭제
  - 사진 썸네일 미리보기 제거
  - 이미지 압축 로직 제거
- ❌ **다중 이메일 주소 입력 제거**
  - 이메일 주소 2, 3번 입력란 삭제
  - 단일 이메일 주소만 유지
- ❌ **PDF 다운로드 버튼 제거**

## 🚧 구현 예정 기능

### 1. 데이터 저장 (선택적)
- ⏳ Cloudflare D1 데이터베이스 통합
- ⏳ 점검표 이력 조회
- ⏳ 통계 대시보드

### 2. 추가 기능
- ⏳ 오프라인 모드 (Service Worker)
- ⏳ 다국어 지원 (영문/중문)
- ⏳ QR 코드 생성 (점검표 링크 공유)

## 🌐 현재 접속 URL

### 프로덕션 (Cloudflare Pages)
- **URL**: https://kvan-checklist.pages.dev ⭐
- **상태**: ⏳ 배포 대기 (Cloudflare API 키 설정 필요)
- **용도**: 실제 사용 (Production)
- **최신 기능**: 3페이지 레이아웃 + 📧 이메일 발송 + ✍️ 정확한 서명!

### 개발 서버 (Sandbox)
- **포트**: 3000
- **상태**: ✅ 실행 중 (PID 7599)
- **용도**: 개발 및 테스트

### GitHub 저장소
- **URL**: https://github.com/lee1481/kvan-checklist
- **최신 커밋**: `a318697` - "fix: JPEG/PNG 다운로드 기능 삭제 - 이메일 발송 기능만 유지"

## 📊 데이터 모델

### Checklist Submission
```javascript
{
  installDate: "2026-02-15",
  vehicleVin: "KMHXX00XXXX",
  mileage: 15000,
  productName: "기아PV5",
  productConfig: "스마트패키지",
  installerName: "홍길동",
  customerName: "김철수",
  customerPhone: "010-1234-5678",
  customerEmail: "customer@example.com",
  installerSignature: "data:image/png;base64,...",
  customerSignature: "data:image/png;base64,...",
  checklist: {
    floor: {
      floor_taegoboard: true,
      floor_aluminum: false,
      floor_accessories: true
    },
    partition_drill: {
      partition_drill_top: true,
      partition_drill_middle: true,
      partition_drill_bottom: false
    },
    // ...
  }
}
```

## 🛠️ 기술 스택

### Frontend
- **HTML5**: 구조 및 마크업
- **Tailwind CSS**: 유틸리티 기반 스타일링 (CDN)
- **Vanilla JavaScript**: 클라이언트 로직
- **Canvas API**: 디지털 서명 기능
- **Axios**: HTTP 클라이언트 (CDN)

### Backend
- **Hono**: 경량 웹 프레임워크
- **Cloudflare Workers**: 엣지 런타임
- **Wrangler**: CLI 도구

### 개발 도구
- **Vite**: 빌드 도구
- **PM2**: 프로세스 매니저
- **Git**: 버전 관리

## 📱 사용 방법

1. **시공 정보 입력** (Page 1)
   - 시공일자, 고객명, 전화번호, 차대번호, 주행거리 입력
   - 고객 서명 캔버스에 서명

2. **제품 선택** (Page 2)
   - 기아PV5 / 밀워키PV5 제품 체크박스 선택
   - 기타 제품은 직접 입력

3. **점검 항목 체크** (Page 3)
   - 6개 섹션별 체크리스트 터치 체크

4. **시공자 정보 및 서명** (Page 1 하단)
   - 시공자명 입력
   - 시공자 서명 캔버스에 서명

5. **이메일 발송** (Page 1 하단)
   - 고객 이메일 주소 입력
   - 📧 이메일 발송 버튼 클릭
   - 이메일로 점검표 자동 발송

## 🔧 로컬 개발 환경 설정

### 1. 프로젝트 클론
```bash
git clone https://github.com/lee1481/kvan-checklist.git
cd kvan-checklist
```

### 2. 의존성 설치
```bash
npm install
```

### 3. 환경 변수 설정
`.dev.vars` 파일 생성:
```
RESEND_API_KEY=your_resend_api_key_here
```

### 4. 개발 서버 시작
```bash
npm run dev
```

### 5. 빌드
```bash
npm run build
```

### 6. 배포
```bash
npm run deploy
```

## 📝 최근 업데이트 (v2.3.0)

### 2026-02-15
- ✅ **JPG/PNG 다운로드 기능 삭제**
  - JPG 다운로드 버튼 제거 (Page 1)
  - PNG 다운로드 버튼 제거
  - `window.downloadJPG` 함수 완전 삭제 (206줄 제거)
  - Loading Overlay 제거
  - 이메일 발송 기능만 유지
  - 빌드 크기 최적화: 94.31 kB (이전 109.57 kB에서 -15.26 kB)

### 2026-02-15 (이전)
- ✅ **Page 1 UI 2단 레이아웃 적용**
  - 고객명 + 전화번호 가로 배치
  - 차대번호 + 주행거리 가로 배치
  - A4 사이즈에 최적화된 공간 활용
  - 전체 높이 약 210px 절감 (1300px+ → 1090px)

## 📞 문의

- **개발자**: 사인마스터
- **이메일**: designsoul2007@gmail.com
- **전화**: 031-666-1901 / 010-3271-1900
- **회사**: (주)케이밴

---

**버전**: v2.3.0 (2026-02-15)  
**라이선스**: MIT  
**최종 업데이트**: 2026-02-15
